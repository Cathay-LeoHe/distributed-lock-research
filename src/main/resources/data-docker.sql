-- Docker 環境 - 示範資料初始化腳本
-- 此腳本包含適合 Docker 多實例環境的示範資料

-- 清理現有資料（如果存在）
DELETE FROM transactions;
DELETE FROM accounts;

-- 插入 Docker 環境的示範帳戶資料（更多帳戶用於測試負載均衡）
INSERT INTO accounts (account_number, balance, status, created_at, updated_at, version) VALUES
-- 主要測試帳戶
('ACC001', 50000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC002', 75000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC003', 60000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC004', 25000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC005', 40000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),

-- 額外的活躍帳戶（用於併發測試）
('ACC006', 100000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC007', 80000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC008', 45000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC009', 90000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC010', 35000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC011', 65000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC012', 55000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC013', 70000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC014', 30000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC015', 85000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),

-- 測試用特殊狀態帳戶
('ACC016', 15000.00, 'INACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC017', 20000.00, 'FROZEN', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC018', 0.00, 'CLOSED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),

-- 高頻交易測試帳戶
('ACC019', 500000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0),
('ACC020', 750000.00, 'ACTIVE', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, 0);

-- 插入 Docker 環境的示範交易記錄（更多交易用於測試分散式鎖性能）
INSERT INTO transactions (transaction_id, from_account, to_account, amount, type, status, created_at, lock_provider, description) VALUES
-- Redis 鎖的成功交易
('TXN001', 'ACC001', 'ACC002', 5000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '1' DAY, 'redis', 'Docker環境轉帳測試 - Redis鎖'),
('TXN002', 'ACC003', 'ACC004', 3000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '2' DAY, 'redis', 'Docker環境轉帳測試 - Redis鎖'),
('TXN003', 'ACC005', 'ACC006', 8000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '3' DAY, 'redis', 'Docker環境轉帳測試 - Redis鎖'),
('TXN004', 'ACC007', 'ACC008', 4500.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '4' DAY, 'redis', 'Docker環境轉帳測試 - Redis鎖'),
('TXN005', 'ACC009', 'ACC010', 6000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '5' DAY, 'redis', 'Docker環境轉帳測試 - Redis鎖'),

-- ZooKeeper 鎖的成功交易
('TXN006', 'ACC011', 'ACC012', 7500.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '6' DAY, 'zookeeper', 'Docker環境轉帳測試 - ZooKeeper鎖'),
('TXN007', 'ACC013', 'ACC014', 2500.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '7' DAY, 'zookeeper', 'Docker環境轉帳測試 - ZooKeeper鎖'),
('TXN008', 'ACC015', 'ACC001', 9000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '8' DAY, 'zookeeper', 'Docker環境轉帳測試 - ZooKeeper鎖'),
('TXN009', 'ACC002', 'ACC003', 3500.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '9' DAY, 'zookeeper', 'Docker環境轉帳測試 - ZooKeeper鎖'),
('TXN010', 'ACC004', 'ACC005', 5500.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '10' DAY, 'zookeeper', 'Docker環境轉帳測試 - ZooKeeper鎖'),

-- 扣款交易（Redis 和 ZooKeeper 混合）
('TXN011', 'ACC006', NULL, 2000.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '11' DAY, 'redis', 'Docker環境扣款測試 - Redis鎖'),
('TXN012', 'ACC007', NULL, 1500.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '12' DAY, 'zookeeper', 'Docker環境扣款測試 - ZooKeeper鎖'),
('TXN013', 'ACC008', NULL, 3000.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '13' DAY, 'redis', 'Docker環境扣款測試 - Redis鎖'),
('TXN014', 'ACC009', NULL, 2500.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '14' DAY, 'zookeeper', 'Docker環境扣款測試 - ZooKeeper鎖'),
('TXN015', 'ACC010', NULL, 1800.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '15' DAY, 'redis', 'Docker環境扣款測試 - Redis鎖'),

-- 高頻交易測試資料
('TXN016', 'ACC019', 'ACC020', 50000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '16' DAY, 'redis', 'Docker環境高頻交易測試 - Redis鎖'),
('TXN017', 'ACC020', 'ACC019', 75000.00, 'TRANSFER', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '17' DAY, 'zookeeper', 'Docker環境高頻交易測試 - ZooKeeper鎖'),
('TXN018', 'ACC019', NULL, 25000.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '18' DAY, 'redis', 'Docker環境高頻扣款測試 - Redis鎖'),
('TXN019', 'ACC020', NULL, 30000.00, 'WITHDRAWAL', 'COMPLETED', CURRENT_TIMESTAMP - INTERVAL '19' DAY, 'zookeeper', 'Docker環境高頻扣款測試 - ZooKeeper鎖'),

-- 失敗交易測試
('TXN020', 'ACC016', 'ACC001', 1000.00, 'TRANSFER', 'FAILED', CURRENT_TIMESTAMP - INTERVAL '20' DAY, 'redis', 'Docker環境失敗測試; 失敗原因: 帳戶非活躍狀態'),
('TXN021', 'ACC017', 'ACC002', 2000.00, 'TRANSFER', 'FAILED', CURRENT_TIMESTAMP - INTERVAL '21' DAY, 'zookeeper', 'Docker環境失敗測試; 失敗原因: 帳戶已凍結'),
('TXN022', 'ACC018', 'ACC003', 500.00, 'TRANSFER', 'FAILED', CURRENT_TIMESTAMP - INTERVAL '22' DAY, 'redis', 'Docker環境失敗測試; 失敗原因: 帳戶已關閉'),

-- 不同狀態的交易（用於測試併發處理）
('TXN023', 'ACC001', 'ACC002', 1000.00, 'TRANSFER', 'PENDING', CURRENT_TIMESTAMP - INTERVAL '2' HOUR, 'redis', 'Docker環境待處理交易'),
('TXN024', 'ACC003', 'ACC004', 1500.00, 'TRANSFER', 'PROCESSING', CURRENT_TIMESTAMP - INTERVAL '1' HOUR, 'zookeeper', 'Docker環境處理中交易'),
('TXN025', 'ACC005', NULL, 800.00, 'WITHDRAWAL', 'PENDING', CURRENT_TIMESTAMP - INTERVAL '3' HOUR, 'redis', 'Docker環境待處理扣款'),
('TXN026', 'ACC006', 'ACC007', 2200.00, 'TRANSFER', 'CANCELLED', CURRENT_TIMESTAMP - INTERVAL '4' HOUR, 'zookeeper', 'Docker環境已取消交易; 取消原因: 系統維護');

-- 顯示初始化完成訊息
SELECT 'Docker environment demo data initialization completed successfully' AS message;